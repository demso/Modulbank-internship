# BankAccounts

[![.NET](https://img.shields.io/badge/.NET-9.0-blue)]()
[![C#](https://img.shields.io/badge/C%23-13-purple)]()
[![Docker API Image Size (latest by date)](https://img.shields.io/docker/image-size/lithiumkgp/bankaccounts.api)](https://hub.docker.com/r/lithiumkgp/bankaccounts.api)

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å "Bank Accounts" (–°–µ—Ä–≤–∏—Å –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Å—á–µ—Ç–æ–≤) –¥–ª—è —Ä–æ–∑–Ω–∏—á–Ω–æ–≥–æ –±–∞–Ω–∫–∞. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ —Å—á–µ—Ç–∞–º–∏, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –≤—ã–ø–∏—Å–∫–∞–º–∏.

–°–µ—Ä–≤–∏—Å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –Ω–∞–¥–µ–∂–Ω—ã–π –æ–±–º–µ–Ω —Å–æ–±—ã—Ç–∏—è–º–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –±–∞–Ω–∫–∞ —á–µ—Ä–µ–∑ **RabbitMQ**, –∏—Å–ø–æ–ª—å–∑—É—è –ø–∞—Ç—Ç–µ—Ä–Ω—ã **Transactional Outbox** (–¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏) –∏ **Inbox** (–¥–ª—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è) –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –±–µ–∑ –ø–æ—Ç–µ—Ä—å –∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

## üìö –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞–º–∏ (—Ç–µ–∫—É—â–∏–µ, –¥–µ–ø–æ–∑–∏—Ç–Ω—ã–µ, –∫—Ä–µ–¥–∏—Ç–Ω—ã–µ).
- –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, —Å–ø–∏—Å–∞–Ω–∏–µ, –ø–µ—Ä–µ–≤–æ–¥—ã –º–µ–∂–¥—É —Å—á–µ—Ç–∞–º–∏).
- –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –ø–æ —Å—á–µ—Ç–∞–º (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ —á–µ—Ä–µ–∑ Hangfire).
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—ã–ø–∏—Å–æ–∫.
- –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ (`ClientBlocked`/`ClientUnblocked`) –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–∏—Å—Ç–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, Antifraud) –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π.
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π (`AccountOpened`, `MoneyCredited`, `MoneyDebited`, `TransferCompleted`, `InterestAccrued`) –≤ RabbitMQ.
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Testcontainers.

## üì¶ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ (RabbitMQ)

–°–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç RabbitMQ –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.

### –¢–æ–ø–æ–ª–æ–≥–∏—è

- **Exchange:** `account.events` (—Ç–∏–ø: `topic`)
- **–û—á–µ—Ä–µ–¥–∏ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è:**
  - `account.crm`: –ü—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ `account.events` —Å routing key `account.*`. –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –æ—Ç–∫—Ä—ã—Ç–∏–µ–º —Å—á–µ—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `AccountOpened`).
  - `account.notifications`: –ü—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ `account.events` —Å routing key `money.*`. –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –¥–µ–Ω—å–≥–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `MoneyCredited`, `MoneyDebited`, `TransferCompleted`).
  - `account.antifraud`: –ü—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ `account.events` —Å routing key `client.*`. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ—Ä–≤–∏—Å–æ–º "–°—á–µ—Ç–∞" –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ (`ClientBlocked`, `ClientUnblocked`).
  - `account.audit`: –ü—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ `account.events` —Å routing key `#` (–ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞—É–¥–∏—Ç–∞.

### –ü–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏–π

1. **–ü—É–±–ª–∏–∫–∞—Ü–∏—è:** –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –±–∏–∑–Ω–µ—Å-–æ–ø–µ—Ä–∞—Ü–∏–π (–æ—Ç–∫—Ä—ã—Ç–∏–µ —Å—á–µ—Ç–∞, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∏ —Ç.–¥.) —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ exchange `account.events` —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ routing keys.
2. **–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ:** –°–µ—Ä–≤–∏—Å –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è `ClientBlocked`/`ClientUnblocked` –∏–∑ –æ—á–µ—Ä–µ–¥–∏ `account.antifraud`, —á—Ç–æ–±—ã –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤.

## üöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
### –ó–∞–ø—É—Å–∫ —Å –ø–æ–º–æ—â—å—é Docker Compose (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
>**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–µ—Ä–≤–∏—Å–∞ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ - –æ—Ç–∫–ª—é—á–∏—Ç–µ VPN –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å.

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ (–≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è `docker-compose.yml`).
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```bash
   docker-compose up
```

   –≠—Ç–æ —Å–æ–±–µ—Ä–µ—Ç Docker-–æ–±—Ä–∞–∑—ã –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Å—á–µ—Ç–æ–≤, —Å–µ—Ä–≤–∏—Å–∞ Identity, PostgreSQL –∏ RabbitMQ.\
3. –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã:
   - **API —Å–µ—Ä–≤–∏—Å–∞ –∏ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [http://localhost](http://localhost)
   - **–°–µ—Ä–≤–∏—Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:** [http://localhost:7045](http://localhost:7045)
   - **RabbitMQ Management UI:** [http://localhost:15672](http://localhost:15672) (–õ–æ–≥–∏–Ω: `admin`, –ü–∞—Ä–æ–ª—å: `admin` - —Å–º. `docker-compose.yml`)
   - **Hangfire Dashboard:** [http://localhost/hangfire](http://localhost/hangfire)
4. –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Ctrl+C` –∏ –∫–æ–º–∞–Ω–¥—É:
```bash
    docker-compose down
```


>**–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å docker-compose –∏ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑—ã (–≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞):
>
>```bash
>docker-compose down -v
>docker-compose up
>```
>**–î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –∑–∞–ø—É—Å–∫–∞** - –≤—ã–±–µ—Ä–∏—Ç–µ `docker-compose` –≤ —Å–ø–∏—Å–∫–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π Visual Studio –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ:
>
><img width="298" height="126" alt="image" src="https://github.com/user-attachments/assets/3d809f2a-7c94-47de-8404-353b9f8ca46c" />
>
> ### "Error response from daemon: Conflict."
>–í –°–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ **`"Error response from daemon: Conflict. The container name "/bankaccounts_db" is already in use..."`** —É–¥–∞–ª–∏—Ç–µ –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ Docker Desktop –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å.


## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç unit-—Ç–µ—Å—Ç—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã.

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:
```bash
docker-compose pull
dotnet test bankaccounts.tests --logger "console;verbosity=detailed"
```
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç Testcontainers –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ PostgreSQL –∏ RabbitMQ.
>**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ï—Å–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π (`502 BadGateway`):
> - –û—Ç–∫–ª—é—á–∏—Ç–µ VPN
> - –£–¥–∞–ª–∏—Ç–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ Docker Desktop 

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `BankAccounts.Api/`: –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Å—á–µ—Ç–æ–≤.
  - `Features/`: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ (Accounts, Transactions).
  - `Infrastructure/`: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, —Å–µ—Ä–≤–∏—Å—ã, Hangfire.
  - `Common/`: –û–±—â–∏–µ –∫–ª–∞—Å—Å—ã (–æ—à–∏–±–∫–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—è, MbResult).
  - `Middleware/`: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ middleware (CustomExceptionHandlerMiddleware).
  - `Migrations/`: –ú–∏–≥—Ä–∞—Ü–∏–∏ Entity Framework Core.
- `BankAccounts.Identity/`: –°–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
  - `Identity/`: –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è IdentityServer.
- `BankAccounts.Tests/`: –ü—Ä–æ–µ–∫—Ç —Å unit –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏.
  - `Unit/`: –¢–µ—Å—Ç—ã –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤.
  - `Integration/`: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Testcontainers.

## ‚öôÔ∏è –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö, PostgreSQL

### –ò–Ω–¥–µ–∫—Å—ã –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–Ω–¥–µ–∫—Å—ã:

- –•—ç—à-–∏–Ω–¥–µ–∫—Å –ø–æ `OwnerId` –≤ —Ç–∞–±–ª–∏—Ü–µ `Accounts`.
- B-Tree –∏–Ω–¥–µ–∫—Å –ø–æ `(AccountId, DateTime)` –≤ —Ç–∞–±–ª–∏—Ü–µ `Transactions`.
- GiST –∏–Ω–¥–µ–∫—Å –ø–æ `DateTime` –≤ —Ç–∞–±–ª–∏—Ü–µ `Transactions` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

### –ü–µ—Ä–µ–≤–æ–¥ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤

–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –º–µ–∂–¥—É —Å—á–µ—Ç–∞–º–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∞ **–æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—è `xmin`. –¢–∞–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏—Å–∫–ª—é—á–∞–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤. –í –∫–ª–∞—Å—Å–µ `PerformTransferHandler` –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ **Entity Framework** –º–µ—Ö–∞–Ω–∏–∑–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–π –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –æ—Ç–º–µ–Ω—è–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

## üß∞ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

*   **–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:** C# 13
*   **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** .NET 9
*   **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
    *   Vertical Slice Architecture
    *   CQRS (Command Query Responsibility Segregation)
*   **–û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏:**
    *   ASP.NET Core (Web API)
    *   Entity Framework Core (—Ä–∞–±–æ—Ç–∞ —Å PostgreSQL)
    *   MediatR (–º–µ–¥–∏–∞—Ç–æ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –∑–∞–ø—Ä–æ—Å–æ–≤)
    *   AutoMapper (—Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤)
    *   FluentValidation (–≤–∞–ª–∏–¥–∞—Ü–∏—è)
    *   Duende IdentityServer (—Å–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ JWT)
    *   RabbitMQ.Client (—Ä–∞–±–æ—Ç–∞ —Å –æ—á–µ—Ä–µ–¥—è–º–∏ —Å–æ–æ–±—â–µ–Ω–∏–π RabbitMQ)
    *   Hangfire (—Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤)
    *   Serilog (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
    *   Swashbuckle (Swagger/OpenAPI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
*   **–ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
    *   Repository
    *   Mediator (—á–µ—Ä–µ–∑ MediatR)
    *   CQRS (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏)
    *   Transactional Outbox (–¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π –≤ RabbitMQ)
    *   Inbox (–¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –∏–∑ RabbitMQ)
    *   Idempotency (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π)
    *   Optimistic Concurrency Control (–æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `xmin` PostgreSQL –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≥–æ–Ω–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö)
    *   Middleware (Custom Exception Handler Middleware –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫)
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
    *   PostgreSQL
    *   –ú–∏–≥—Ä–∞—Ü–∏–∏ Entity Framework Core
    *   –ò–Ω–¥–µ–∫—Å—ã (Hash, B-Tree, GiST) –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
    *   –•—Ä–∞–Ω–∏–º–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ (–¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤)
*   **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:**
    *   Docker
    *   Docker Compose
*   **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
    *   xUnit
    *   Moq
    *   Testcontainers (–¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ PostgreSQL)
*   **–ü—Ä–æ—á–µ–µ:**
    *   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –µ–¥–∏–Ω–æ–≥–æ —Ç–∏–ø–∞ `MbResult<T>` –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ API.
    *   –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Serilog) —Å –∑–∞–ø–∏—Å—å—é –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ (–≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Å–æ–±—ã—Ç–∏–π –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏).
    *   Health Checks –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞, –ë–î –∏ –æ—á–µ—Ä–µ–¥–µ–π.
